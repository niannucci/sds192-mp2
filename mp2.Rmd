---
title: "Mini-Project 2"
author: "Natalia Iannucci and Hana Hirano"
date: "2019-03-24"
output: 
  html_document:
    code_folding: hide
---

## Loading the data

```{r, message = FALSE}
library(tidyverse)
library(ggthemes)
load("house_elections.rda")
load("candidates.rda")
load("committees.rda")
load("contributions.rda")
```

The power of negative gossip, rumor, information is strong. [A research](http://science.sciencemag.org/content/332/6036/1446) suggests that it can even influence our visual processing and can last in our memory for longer period of time compared to positive or neutral information. When in elections, some candidates emphasize their opponentsâ€™ past mistakes or spread false negative rumors. 

In this mini-project, using the data collected from the Federal Election Committee, our aim is to show how Democrats and Republican candidate use their campaign contributions and how those two major parties differ overall.


First, we filtered two datasets (one on contrubutions and one on house elections information) for the variables that we will examine; the type of transaction (for or opposing a candidate), the political party that the trasaction is in regards to, the transaction amount, and the state in which the transaction occurred. 
```{r, message = FALSE}
contribution_data <- select(contributions, transaction_type, transaction_amt, cand_id, state)
house_election_data <- select(house_elections, fec_id, party, ge_winner)
```

Next we joined the two datasets to get the contributions and elections data together in one dataset.
```{r, message = FALSE}
contributions_to_elections <- contribution_data %>%
  inner_join(house_election_data, by = c("cand_id" = "fec_id")) %>%
  filter(transaction_type %in% c("24A", "24E")) %>%
  filter(party %in% c("D", "R")) %>%
  group_by(state)
```

We wrangled the data to look at total transactions per state to determine which states have the most transactions; we decided to use the ten states with the highest transaction amounts to use in our analysis.
```{r, message = FALSE}
top_states <- contributions_to_elections %>%
  group_by(state) %>%
  summarize(total_transactions = sum(transaction_amt)) %>%
  arrange(desc(total_transactions))
```

Next we filtered the dataset to only include the states with the top total transaction amounts.
```{r, message = FALSE}
top_contribution_states <- contributions_to_elections %>%
  filter(state %in% c('VA', 'DC', 'MD', 'CA', 'IL', 'TX', 'PA', 'FL', 'NY', 'CO'))
```

We then graphed the transaction amounts for the top states according to if they were opposing or supporting a candidate, and which party they were for.

When the data is presented as a bar chart, the audience can easily compare the numbers. As our purpose of this project was to illustrate the difference in Democrats and Republican spend their campaign contributions, we decided that this data presentation should work the best.
```{r, message = FALSE}
ggplot(top_contribution_states, aes(x = party, y = transaction_amt)) +
  geom_bar(stat = "identity", aes(fill = transaction_type), position = "dodge") +
  scale_y_continuous(breaks = c(0, 400000, 800000, 1200000, 1600000, 2000000), labels = c(0, 0.4, 0.8, 1.2, 1.6, 2.0)) +
  ggtitle("Independent Expenditure Transactions per Party for the top 10 States with the Highest Transaction Amounts") +
  xlab("Political Party") +
  ylab("Transaction Amount (in millions of dollars)") +
  facet_wrap(~ state) +
  scale_fill_manual(name = "Type of Transaction",label = c('Opposing Candidate', 'Supporting Candidate'), values = c('red', 'purple')) +
  theme_stata() + 
  scale_color_stata()
```

Total amount of money each party spend for opposing
```{r, message = FALSE}
opposing_total <- function(party_name) {
  contributions_to_elections %>%
    filter(transaction_type == "24E") %>%
    group_by(party) %>%
    filter(party == party_name) %>%
    summarize(total = sum(transaction_amt)) %>%
    head(1)
}
opposing_total(party_name = "D")
opposing_total(party_name = "R")
```


We calculated the total amount of money each party spent supporting a candidate. 
```{r, message = FALSE}
supporting_total <- function(party_name) {
  contributions_to_elections %>%
    filter(transaction_type == "24A") %>%
    group_by(party) %>%
    filter(party == party_name) %>%
    summarize(total = sum(transaction_amt)) %>%
    head(1)
}
supporting_total(party_name = "D")
supporting_total(party_name = "R")
```

This data tells us that the amount of money spent by each party varies significantly in each state, and how they spend their money (opposing a candidate or supporting another) is also different for each state. 



