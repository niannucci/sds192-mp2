---
title: "Mini-Project 2"
author: "Natalia Iannucci and Hana Hirano"
date: "2019-03-24"
output: 
  html_document:
    code_folding: show
---

## Loading the data

```{r, message = FALSE}
library(tidyverse)
library(ggthemes)
load("house_elections.rda")
load("candidates.rda")
load("committees.rda")
load("contributions.rda")
```

Filter for the variables that we will examine
```{r}
contribution_data <- select(contributions, transaction_type, transaction_amt, cand_id, state)
house_election_data <- select(house_elections, fec_id, party, ge_winner)
```

Join datasets to get contribution and election data together
```{r, message = FALSE}
contributions_to_elections <- contribution_data %>%
  inner_join(house_election_data, by = c("cand_id" = "fec_id")) %>%
  filter(transaction_type %in% c("24A", "24E")) %>%
  filter(party %in% c("D", "R")) %>%
  group_by(state)
```

Look at total transactions per state to determine which states have the most transactions to use in analysis
```{r}
top_states <- contributions_to_elections %>%
  group_by(state) %>%
  summarize(total_transactions = sum(transaction_amt)) %>%
  arrange(desc(total_transactions))
```

Filter the data to only include the states with the top total transaction amounts
```{r}
top_contribution_states <- contributions_to_elections %>%
  filter(state %in% c('VA', 'DC', 'MD', 'CA', 'IL', 'TX', 'PA', 'FL', 'NY', 'CO'))
```

Graph the transaction amounts for the top states
```{r}
ggplot(top_contribution_states, aes(x = party, y = transaction_amt)) +
  geom_bar(stat = "identity", aes(fill = transaction_type), position = "dodge") +
  #scale_y_continuous(limits, breaks, labels) +
  #xlab("Political Party") +
  #ylab("Transactions A")
  facet_wrap(~ state) +
  theme_stata() + 
  scale_color_stata()
```

Total amount of money each party spend for opposing
```{r}
opposing_total <- function(party_name) {
  contributions_to_elections %>%
    filter(transaction_type == "24E") %>%
    group_by(party) %>%
    filter(party == party_name) %>%
    summarize(total = sum(transaction_amt)) %>%
    head(1)
}
opposing_total(party_name = "D")
opposing_total(party_name = "R")
```


Total amount of money each party spend for supporting
```{r}
supporting_total <- function(party_name) {
  contributions_to_elections %>%
    filter(transaction_type == "24A") %>%
    group_by(party) %>%
    filter(party == party_name) %>%
    summarize(total = sum(transaction_amt)) %>%
    head(1)
}
supporting_total(party_name = "D")
supporting_total(party_name = "R")
```

> Word count: `r wordcountaddin::word_count()`

